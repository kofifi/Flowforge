const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CanvasControls-CqkpOK84.js","assets/index-BQ9o7mEa.js","assets/reactflow-CgyvNGsb.js","assets/vendor-t4Ks9Nel.js","assets/index-BV73Sp1T.css","assets/Icon-UISONTKN.js"])))=>i.map(i=>d[i]);
import{j as e,_ as H}from"./index-BQ9o7mEa.js";import{r as i,H as m,P as j}from"./reactflow-CgyvNGsb.js";import{I as M}from"./Icon-UISONTKN.js";import"./vendor-t4Ks9Nel.js";const Z=i.memo(function({data:s,id:a}){const c=s.blockType==="Start",p=s.blockType==="End",u=s.blockType==="If",h=s.blockType==="Switch",b=s.blockType==="Loop",$=h?"Route by case labels.":b?"Repeat a branch multiple times.":s.description,v=s.switchCases??[""],w=v.length+1,n=80,y=22,S=h?Math.max(120,n+(w-1)*y+32):void 0,d={width:12,height:12,borderRadius:"50%",background:"var(--handle-default-bg)",border:"2px solid var(--handle-default-border)"},E={width:12,height:12,borderRadius:"50%",background:"var(--handle-success)",border:"2px solid var(--handle-success)"},o={width:12,height:12,borderRadius:"50%",background:"var(--handle-error)",border:"2px solid var(--handle-error)"};return e.jsxs("div",{className:"node-card",style:{position:"relative",height:S?`${S}px`:void 0,padding:"6px 14px",paddingRight:h?46:14},children:[!c&&e.jsx(m,{type:"target",position:j.Left,style:{left:-14,...d}}),e.jsxs("div",{className:"node-header",children:[e.jsx("span",{className:"node-chip",children:s.label}),e.jsx("span",{className:"node-status",children:"Ready"}),e.jsx("button",{type:"button",className:"node-gear","aria-label":"Open block settings",onClick:()=>{var l;return(l=s.onOpenConfig)==null?void 0:l.call(s,{id:a,blockType:s.blockType,label:s.label})},children:e.jsx(M,{name:"gear",size:18})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px",margin:"4px 0 6px"},children:[e.jsxs("p",{className:"node-title",style:{margin:0},children:[s.label," block"]}),e.jsx("p",{className:"node-meta",style:{margin:0,lineHeight:1.3},children:$})]}),!p&&!h&&!b&&e.jsx(m,{type:"source",position:j.Right,id:u?"success":void 0,style:u?{top:"45%",right:-8,...E}:{right:-8,...d}}),u&&s.allowErrorOutput&&e.jsx(m,{type:"source",position:j.Right,id:"error",style:{top:"75%",right:-8,...o}}),b&&e.jsxs(e.Fragment,{children:[e.jsx(m,{type:"source",position:j.Right,id:"loop",style:{top:"45%",right:-8,...d}}),e.jsx("span",{style:{position:"absolute",right:12,top:"45%",transform:"translateY(-50%)",fontSize:11,fontWeight:600,color:"var(--text-muted, #7b8794)",pointerEvents:"none"},children:"loop"}),e.jsx(m,{type:"source",position:j.Right,id:"error",style:{top:"75%",right:-8,...d}}),e.jsx("span",{style:{position:"absolute",right:12,top:"75%",transform:"translateY(-50%)",fontSize:11,fontWeight:600,color:"var(--text-muted, #7b8794)",pointerEvents:"none"},children:"exit"})]}),h&&e.jsxs(e.Fragment,{children:[e.jsx(m,{type:"target",position:j.Left,id:"switch-target",style:{left:-14,top:"50%",...d}}),v.map((l,g)=>{const f=n+g*y;return e.jsxs(i.Fragment,{children:[e.jsx("span",{style:{position:"absolute",right:8,top:`${f}px`,transform:"translateY(-50%)",fontSize:11,fontWeight:600,color:"var(--text-muted, #7b8794)",pointerEvents:"none"},children:g+1}),e.jsx(m,{type:"source",position:j.Right,id:`case-${g+1}`,style:{top:`${f}px`,right:-6,...d}})]},`${a}-case-${g}`)}),(()=>{const l=n+y*v.length;return e.jsxs(i.Fragment,{children:[e.jsx("span",{style:{position:"absolute",right:8,top:`${l}px`,transform:"translateY(-50%)",fontSize:11,fontWeight:600,color:"var(--text-muted, #7b8794)",pointerEvents:"none"},children:"default"}),e.jsx(m,{type:"source",position:j.Right,id:"default",style:{top:`${l}px`,right:-6,...d}})]},`${a}-case-default`)})()]})]})}),X=i.lazy(()=>H(()=>import("./CanvasControls-CqkpOK84.js"),__vite__mapDeps([0,1,2,3,4,5]))),G=r=>({id:s,sourceX:a,sourceY:c,targetX:p,targetY:u,sourcePosition:h,targetPosition:b,style:$,markerEnd:v,label:w,data:n})=>{const y=(n==null?void 0:n.parallelOffset)??0,S=(n==null?void 0:n.labelBgPadding)??[6,4],d=(n==null?void 0:n.labelBgBorderRadius)??10,E=(n==null?void 0:n.labelBgStyle)??{fill:"rgba(0,0,0,0.55)"},o=(n==null?void 0:n.labelStyle)??{fill:"#fff",fontWeight:600,fontSize:11},l=p-a,g=u-c,f=Math.sqrt(l*l+g*g)||1,k=-g/f*y,B=l/f*y,[P,R,F]=r.getBezierPath({sourceX:a+k,sourceY:c+B,targetX:p+k,targetY:u+B,sourcePosition:h,targetPosition:b});return e.jsxs(e.Fragment,{children:[e.jsx(r.BaseEdge,{id:s,path:P,style:$,markerEnd:v}),w?e.jsx(r.EdgeLabelRenderer,{children:e.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${R}px, ${F}px)`,background:E.fill??"rgba(0,0,0,0.55)",color:(o==null?void 0:o.fill)??"#fff",padding:`${S[1]}px ${S[0]}px`,borderRadius:d,fontWeight:(o==null?void 0:o.fontWeight)??600,fontSize:(o==null?void 0:o.fontSize)??11,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",pointerEvents:"all",whiteSpace:"nowrap"},children:w})}):null]})};function J({module:r,nodes:s,setNodes:a,edges:c,setEdges:p,snapToGrid:u,isDragging:h,setIsDragging:b,workflowLoading:$,graphLoading:v,onConnect:w,onEdgeClick:n,onNodeClick:y,onNodeContextMenu:S,onSelectionChange:d,onSelectionContextMenu:E,onPaneClick:o,onPaneContextMenu:l,onToggleSnap:g,onNodesMutate:f,onEdgesMutate:k}){const B=i.useMemo(()=>({styledEdge:G(r)}),[r]),P=i.useMemo(()=>({flowNode:Z}),[]),R=i.useRef(null),{fitView:F,zoomIn:N,zoomOut:L}=r.useReactFlow(),{zoom:O}=r.useViewport(),A=i.useMemo(()=>{const x=new Map;return c.forEach(t=>{const C=`${t.source}-${t.target}-${t.sourceHandle??"default"}-${t.targetHandle??"default"}`,z=x.get(C)??[];z.push(t),x.set(C,z)}),c.map(t=>{var _,I,W;const C=`${t.source}-${t.target}-${t.sourceHandle??"default"}-${t.targetHandle??"default"}`,z=x.get(C)??[],Y=z.findIndex(D=>D.id===t.id),q=z.length>1?(Y-(z.length-1)/2)*18:0;return{...t,animated:!0,type:"styledEdge",markerEnd:t.markerEnd??{type:r.MarkerType.ArrowClosed,color:((_=t.style)==null?void 0:_.stroke)??"#2f9e68"},style:{stroke:((I=t.style)==null?void 0:I.stroke)??"#2f9e68",strokeWidth:((W=t.style)==null?void 0:W.strokeWidth)??2.5,filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.15))",...t.style},labelBgPadding:t.labelBgPadding??[6,4],labelBgBorderRadius:t.labelBgBorderRadius??10,labelBgStyle:t.labelBgStyle??{fill:"rgba(0,0,0,0.55)",stroke:"none"},labelStyle:t.labelStyle??{fill:"#fff",fontWeight:600,fontSize:11},data:{...t.data??{},parallelOffset:q}}})},[c,h,r]),T=i.useCallback(x=>{f==null||f(x),a(t=>r.applyNodeChanges(x,t))},[r,f,a]),V=i.useCallback(x=>{k==null||k(x),p(t=>r.applyEdgeChanges(x,t))},[r,k,p]);return e.jsx("div",{className:`canvas-wrapper ${h?"is-dragging":""}`,children:e.jsxs("div",{className:"canvas",style:{background:"radial-gradient(circle at 30% 30%, rgba(0,0,0,0.04), transparent 55%), linear-gradient(135deg, rgba(0,0,0,0.02) 25%, transparent 25%, transparent 50%, rgba(0,0,0,0.02) 50%, rgba(0,0,0,0.02) 75%, transparent 75%, transparent)",backgroundSize:"100% 100%, 48px 48px"},children:[e.jsx(r.ReactFlow,{nodes:s,edges:A,edgeTypes:B,style:{width:"100%",height:"100%"},onNodesChange:T,onEdgesChange:V,onConnect:w,onEdgeClick:n,onNodeClick:y,onNodeContextMenu:S,onSelectionChange:d,onSelectionContextMenu:E,onPaneClick:o,onMoveStart:()=>b(!0),onMoveEnd:()=>{R.current&&cancelAnimationFrame(R.current),R.current=requestAnimationFrame(()=>{b(!1),R.current=null})},onPaneContextMenu:l,nodeTypes:P,snapToGrid:u,snapGrid:[16,16],fitView:!0,proOptions:{hideAttribution:!0}}),v&&e.jsx("div",{className:"canvas-loading",style:{position:"absolute",inset:0,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, rgba(255,255,255,0.85), rgba(240,245,240,0.85))",color:"#2f9e68",fontWeight:700,letterSpacing:.4,backdropFilter:"blur(2px)",zIndex:5},children:e.jsxs("div",{style:{display:"grid",gap:6,textAlign:"center"},children:[e.jsx("span",{style:{fontSize:13,opacity:.7},children:"Preparing canvas"}),e.jsx("span",{style:{fontSize:15},children:"Loading workflow graph..."})]})}),$&&e.jsx("div",{style:{position:"absolute",inset:"auto 16px 16px auto",background:"rgba(255,255,255,0.9)",padding:"10px 12px",borderRadius:8,color:"#0f172a",fontSize:14,border:"1px solid rgba(15,23,42,0.08)",fontWeight:700,letterSpacing:.4,backdropFilter:"blur(2px)",zIndex:5},children:e.jsxs("div",{style:{display:"grid",gap:6,textAlign:"center"},children:[e.jsx("span",{style:{fontSize:13,opacity:.7},children:"Preparing canvas"}),e.jsx("span",{style:{fontSize:15},children:"Loading workflow graph..."})]})}),e.jsx(i.Suspense,{fallback:e.jsx("div",{}),children:e.jsx(X,{zoomPercent:Math.round(O*100),snapToGrid:u,onZoomIn:()=>N({duration:200}),onZoomOut:()=>L({duration:200}),onFitView:()=>F({padding:.2,duration:220}),onToggleSnap:g})})]})})}function se(r){const[s,a]=i.useState(null);return i.useEffect(()=>{let c=!0;return H(()=>import("./reactflow-CgyvNGsb.js").then(p=>p.i),[]).then(p=>{c&&a(p)}),()=>{c=!1}},[]),s?e.jsx(J,{module:s,...r}):e.jsx("div",{className:"canvas-wrapper",children:e.jsx("div",{className:"canvas-loading",children:e.jsxs("div",{style:{display:"grid",gap:6,textAlign:"center"},children:[e.jsx("span",{style:{fontSize:13,opacity:.7},children:"Preparing canvas"}),e.jsx("span",{style:{fontSize:15},children:"Loading editor..."})]})})})}export{se as default};
