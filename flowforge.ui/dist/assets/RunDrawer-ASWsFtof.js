import{j as e}from"./index-BQ9o7mEa.js";import{r as j}from"./reactflow-CgyvNGsb.js";import{I as C}from"./Icon-UISONTKN.js";import"./vendor-t4Ks9Nel.js";function O(a){return!a||typeof a!="object"?{}:Object.fromEntries(Object.entries(a).map(([i,n])=>[i,typeof n=="string"?n:JSON.stringify(n,null,2)]))}function T(a){if(!Number.isFinite(a)||a<=0)return"0 ms";if(a<1e3)return`${Math.round(a)} ms`;const i=a/1e3;if(i<60)return`${i.toFixed(i>=10?0:1)} s`;const n=Math.floor(i/60),o=Math.round(i%60);return`${n}m ${o}s`}const M=({workflowId:a,workflowName:i,variables:n,runInputs:o,setRunInputs:u,running:m,runError:h,runResult:t,skipWaits:N,setSkipWaits:f,estimatedWaitMs:w,showRunSnippet:b,setShowRunSnippet:g,showRunInputs:v,setShowRunInputs:k,onRun:p,onClose:x})=>{const[c,y]=j.useState(b),[d,S]=j.useState(v);return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"drawer-backdrop",onClick:x}),e.jsxs("aside",{className:"config-drawer",children:[e.jsxs("div",{className:"drawer-header",children:[e.jsxs("div",{children:[e.jsx("p",{className:"drawer-title",children:"Run workflow"}),e.jsx("span",{className:"drawer-subtitle",children:i})]}),e.jsx("button",{type:"button",className:"ghost",onClick:x,children:"Close"})]}),e.jsxs("section",{className:"variables-section",children:[e.jsxs("div",{className:"section-toggle",style:{marginBottom:c?8:0},children:[e.jsxs("div",{className:"section-toggle__meta",children:[e.jsx("span",{className:"section-title",children:"API snippet"}),e.jsx("span",{className:"section-subtitle",children:"HTTP call template"})]}),e.jsx("button",{type:"button",className:"icon-button",onClick:()=>{y(s=>!s),g(s=>!s)},"aria-label":c?"Collapse snippet":"Expand snippet",children:e.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",style:{transform:c?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s ease"},"aria-hidden":"true",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"1.8",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),c&&e.jsxs("div",{className:"variables-section",style:{gap:8},children:[e.jsxs("p",{className:"muted",children:["1) Replace ",e.jsx("code",{children:"<API_BASE>"})," with your backend URL.",e.jsx("br",{}),"2) Fill variable values in the JSON body.",e.jsx("br",{}),"3) Run in terminal (curl) or any HTTP client (Postman)."]}),e.jsxs("div",{className:"code-card",children:[e.jsxs("div",{className:"code-card__header",children:[e.jsx("span",{children:"curl"}),e.jsx("span",{className:"muted",children:"HTTP POST"})]}),e.jsx("pre",{className:"code-block",children:`curl -X POST \\
  "<API_BASE>/api/Workflow/${a??"ID"}/run" \\
  -H "Content-Type: application/json" \\
  -d '${JSON.stringify(n.reduce((s,l)=>(s[l.name]=l.defaultValue??"",s),{}),null,2)}'`})]}),e.jsx("p",{className:"muted",children:"Response returns execution id, path, actions, and output variables as JSON."})]}),e.jsx("div",{className:"section-header",children:e.jsxs("div",{className:"section-toggle",children:[e.jsxs("div",{className:"section-toggle__meta",children:[e.jsx("span",{className:"section-title",children:"Inputs"}),e.jsxs("span",{className:"section-subtitle",children:[n.length," variables"]})]}),e.jsx("button",{type:"button",className:"icon-button",onClick:()=>{S(s=>!s),k(s=>!s)},"aria-label":d?"Collapse inputs":"Expand inputs",children:e.jsx("svg",{viewBox:"0 0 24 24",width:"18",height:"18",style:{transform:d?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.15s ease"},"aria-hidden":"true",children:e.jsx("path",{d:"M6 9l6 6 6-6",stroke:"currentColor",strokeWidth:"1.8",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"})})})]})}),d&&e.jsxs("form",{className:"drawer-form",onSubmit:s=>{s.preventDefault(),p()},children:[n.length===0&&e.jsx("p",{className:"muted",children:"No workflow variables defined."}),n.map(s=>e.jsxs("div",{className:"combo",children:[e.jsxs("label",{className:"drawer-label",htmlFor:`run-${s.id}`,children:[e.jsx("span",{className:"label-icon",children:e.jsx(C,{name:"rows"})}),s.name]}),e.jsx("input",{id:`run-${s.id}`,type:"text",value:o[s.name]??"",onChange:l=>{const r=l.target.value;u(E=>({...E,[s.name]:r}))}})]},s.id))]}),e.jsxs("div",{className:"wait-summary",children:[e.jsxs("div",{className:"wait-summary__meta",children:[e.jsx("span",{className:"pill",children:T(w)}),e.jsx("span",{className:"muted",children:"Estimated waits"})]}),e.jsxs("label",{className:"switch",children:[e.jsx("input",{type:"checkbox",checked:N,onChange:s=>f(s.target.checked)}),e.jsx("span",{className:"switch-slider"}),e.jsx("span",{className:"muted",children:"Skip wait blocks (UI only)"})]})]}),e.jsx("button",{type:"button",disabled:m,onClick:p,style:{marginTop:8},children:m?"Running...":"Run workflow"}),h&&e.jsx("p",{className:"muted",children:h})]}),t&&e.jsxs("section",{className:"variables-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("p",{className:"section-title",children:"Result"}),e.jsxs("span",{className:"section-subtitle",children:["Execution #",t.id]})]}),e.jsxs("div",{className:"drawer-empty",children:[e.jsx("p",{className:"label",children:"Flow"}),t.path&&t.path.length>0?e.jsx("div",{className:"flow-wrapper",children:e.jsx("div",{className:"flow-lane flow-scroll",children:(t.path??[]).map((s,l)=>{var r;return e.jsxs("div",{className:"flow-segment",children:[e.jsxs("div",{className:"flow-node",children:[e.jsxs("div",{className:"flow-node-top",children:[e.jsx("span",{className:"flow-index",children:l+1}),e.jsx("span",{className:"flow-badge",children:"Executed"})]}),e.jsx("span",{className:"flow-label",children:s}),t.actions&&t.actions[l]&&e.jsx("span",{className:"flow-note",children:t.actions[l]})]}),l<(((r=t.path)==null?void 0:r.length)??0)-1&&e.jsx("div",{className:"flow-connector"})]},`${s}-${l}`)})})}):e.jsx("p",{className:"meta",children:"No path recorded."})]}),e.jsxs("div",{className:"drawer-empty",children:[e.jsx("p",{className:"label",children:"Output variables"}),e.jsx("pre",{className:"meta",children:JSON.stringify(O(t.resultData),null,2)})]})]})]})]})};export{M as default};
