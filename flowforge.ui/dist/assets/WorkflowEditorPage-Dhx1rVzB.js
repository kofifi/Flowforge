const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CanvasSidebar-HDQYqd1E.js","assets/index-BQ9o7mEa.js","assets/reactflow-CgyvNGsb.js","assets/vendor-t4Ks9Nel.js","assets/index-BV73Sp1T.css","assets/Icon-UISONTKN.js","assets/BlocksDrawer--FaO8e-q.js","assets/VariablesDrawer-Barztu4c.js","assets/FlowCanvas-PceQvTHR.js","assets/FlowCanvas-D9J-1DAv.css","assets/RunDrawer-ASWsFtof.js","assets/ConfigDrawer-c_WVCtbD.js","assets/EditorTopbar-CLNVwTDm.js","assets/ContextMenus-DpptKhvV.js"])))=>i.map(i=>d[i]);
var as=Object.defineProperty;var ss=(l,o,n)=>o in l?as(l,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[o]=n;var dt=(l,o,n)=>ss(l,typeof o!="symbol"?o+"":o,n);import{j as S,_ as se}from"./index-BQ9o7mEa.js";import{r as a,c as os,u as ns,d as rs,e as is}from"./reactflow-CgyvNGsb.js";import{u as ls}from"./useThemePreference-BiXiARFG.js";import{b as cs}from"./vendor-t4Ks9Nel.js";function J(l){if(Array.isArray(l))return l;if(l&&typeof l=="object"&&"$values"in l){const o=l.$values;return Array.isArray(o)?o:[]}return[]}function us(l){a.useEffect(()=>(document.body.classList.add(l),()=>{document.body.classList.remove(l)}),[l])}const yt={},{useDebugValue:ds}=rs,{useSyncExternalStoreWithSelector:fs}=ns;let oa=!1;const ps=l=>l;function gs(l,o=ps,n){(yt?"production":void 0)!=="production"&&n&&!oa&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),oa=!0);const f=fs(l.subscribe,l.getState,l.getServerState||l.getInitialState,o,n);return ds(f),f}const na=l=>{(yt?"production":void 0)!=="production"&&typeof l!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const o=typeof l=="function"?os(l):l,n=(f,V)=>gs(o,f,V);return Object.assign(n,o),n},ys=l=>l?na(l):na;var bs=l=>((yt?"production":void 0)!=="production"&&console.warn("[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`."),ys(l));const ms="".replace(/\/$/,"");class hs extends Error{constructor(n,f,V){super(n);dt(this,"status");dt(this,"body");this.status=f,this.body=V}}async function ws(l){try{return await l.json()}catch{return null}}async function ke(l,o={}){const n=await fetch(`${ms}${l}`,o),f=await ws(n);if(!n.ok){const V=f&&typeof f=="object"&&"message"in f&&f.message||`Request failed (${n.status})`;throw new hs(V,n.status,f)}return f}function ra(l,o={}){return{...o,method:o.method??"POST",headers:{"Content-Type":"application/json",...o.headers??{}},body:JSON.stringify(l)}}function ft(l){const o=Number(l);return Number.isFinite(o)?o:0}function Ss(l){if(!l||typeof l!="object")return{id:0,name:"",defaultValue:null,workflowId:0};const o=l,n=o.workflow??o.Workflow,f=ft(o.workflowId??o.WorkflowId??(n==null?void 0:n.id)??(n==null?void 0:n.Id));return{id:ft(o.id??o.Id),name:o.name??o.Name??"",defaultValue:o.defaultValue??o.DefaultValue??null,workflowId:f,workflow:n?{id:ft(n.id??n.Id),name:""}:void 0}}function ks(l){const o=J(l),n=o.flatMap(f=>{if(!f||typeof f!="object")return[];const V=f.workflow??f.Workflow;if(!V||typeof V!="object")return[];const I=V.workflowVariables??V.WorkflowVariables;return J(I)});return[...o,...n]}function Es(l){return Array.from(l.reduce((o,n)=>{const f=`${n.workflowId}-${n.id}-${n.name}`;return o.has(f)||o.set(f,n),o},new Map),([,o])=>o)}const Cs=bs((l,o)=>({workflow:null,workflowLoading:!1,workflowError:null,variables:[],variablesLoading:!1,variablesError:null,clearVariablesError:()=>l({variablesError:null}),loadWorkflow:async n=>{l({workflowLoading:!0,workflowError:null});try{const f=await ke(`/api/Workflow/${n}`);l({workflow:f})}catch(f){l({workflowError:f instanceof Error?f.message:"Unable to load workflow",workflow:null})}finally{l({workflowLoading:!1})}},loadVariables:async n=>{l({variablesLoading:!0,variablesError:null});try{const f=await ke("/api/WorkflowVariable"),I=ks(f).map(Ss).filter($=>$.id!==0&&$.workflowId===n);l({variables:Es(I)})}catch(f){l({variablesError:f instanceof Error?f.message:"Unable to load variables"})}finally{l({variablesLoading:!1})}},createVariable:async({name:n,defaultValue:f,workflowId:V})=>{try{await ke("/api/WorkflowVariable",ra({name:n,defaultValue:f,workflowId:V},{method:"POST"})),await o().loadVariables(V)}catch(I){throw l({variablesError:I instanceof Error?I.message:"Unable to create variable"}),I}},updateVariable:async({id:n,name:f,defaultValue:V,workflowId:I})=>{try{await ke(`/api/WorkflowVariable/${n}`,ra({id:n,name:f,defaultValue:V,workflowId:I,workflow:null},{method:"PUT"})),await o().loadVariables(I)}catch($){throw l({variablesError:$ instanceof Error?$.message:"Unable to update variable"}),$}},deleteVariable:async(n,f)=>{try{await ke(`/api/WorkflowVariable/${n}`,{method:"DELETE"}),await o().loadVariables(f)}catch(V){throw l({variablesError:V instanceof Error?V.message:"Unable to delete variable"}),V}}}));function Ts({nodes:l,edges:o,setNodes:n,setEdges:f,markDirty:V}){const I=a.useRef([]),$=a.useRef(null),Te=a.useRef(!1);return{historyRef:I,clipboardRef:$,initialSnapshotCaptured:Te,pushHistory:()=>{I.current=[...I.current.slice(-49),{nodes:ia(l),edges:la(o)}]},undoHistory:()=>{if(I.current.length===0)return;const Y=I.current[I.current.length-1];I.current=I.current.slice(0,-1),n(Y.nodes),f(Y.edges),V()},copySelection:Y=>{const ye=l.filter(ue=>Y.includes(ue.id)),Q=o.filter(ue=>Y.includes(ue.source)&&Y.includes(ue.target));$.current={nodes:ia(ye),edges:la(Q)}},pasteClipboard:()=>$.current}}function ia(l){return l.map(o=>({...o,data:{...o.data},position:{...o.position}}))}function la(l){return l.map(o=>({...o,data:o.data?{...o.data}:void 0}))}function Vs(l){return l.map(o=>({...o,data:{...o.data},position:{...o.position}}))}function xs(l){return l.map(o=>({...o,data:o.data?{...o.data}:void 0}))}const vs=a.lazy(()=>se(()=>import("./CanvasSidebar-HDQYqd1E.js"),__vite__mapDeps([0,1,2,3,4,5]))),Is=a.lazy(()=>se(()=>import("./BlocksDrawer--FaO8e-q.js"),__vite__mapDeps([6,1,2,3,4]))),Rs=a.lazy(()=>se(()=>import("./VariablesDrawer-Barztu4c.js"),__vite__mapDeps([7,1,2,3,4,5]))),Ns=a.lazy(()=>se(()=>import("./FlowCanvas-PceQvTHR.js"),__vite__mapDeps([8,1,2,3,4,5,9]))),js=a.lazy(()=>se(()=>import("./RunDrawer-ASWsFtof.js"),__vite__mapDeps([10,1,2,3,4,5]))),$s=a.lazy(()=>se(()=>import("./ConfigDrawer-c_WVCtbD.js"),__vite__mapDeps([11,1,2,3,4]))),Ds=a.lazy(()=>se(()=>import("./EditorTopbar-CLNVwTDm.js"),__vite__mapDeps([12,1,2,3,4,5]))),Ms=a.lazy(()=>se(()=>import("./ContextMenus-DpptKhvV.js"),__vite__mapDeps([13,1,2,3,4]))),pt="#7a8899";function Ee(l){if(!Array.isArray(l))return[""];const o=l.map(n=>typeof n=="string"?n:"").filter((n,f)=>f>=0);return o.length===0?[""]:o}function _e(l){const o=l.trim();return o.startsWith("$")?o.slice(1):o}function Ls(l){const o=l.trim();return o?o.startsWith("$")?o:`$${o}`:""}function Ce(l,o){const n=l+1;return o&&o.length>0?`#${n} Â· ${o}`:`#${n}`}const G="".replace(/\/$/,""),Oe=[{type:"Start",label:"Start",description:"Entry point for the workflow.",category:"Flow"},{type:"End",label:"End",description:"Finish the workflow.",category:"Flow"},{type:"If",label:"If",description:"Route based on a condition.",category:"Logic"},{type:"Switch",label:"Switch",description:"Multi-branch on cases",category:"Logic"},{type:"Loop",label:"Loop",description:"Repeat a branch multiple times.",category:"Logic"},{type:"Wait",label:"Wait",description:"Pause execution for a duration.",category:"Flow"},{type:"Calculation",label:"Calculation",description:"Compute variables.",category:"Logic"},{type:"TextTransform",label:"Text Transform",description:"Trim / lower / upper.",category:"Logic"},{type:"TextReplace",label:"Text Replace",description:"Replace text literal/regex.",category:"Logic"},{type:"HttpRequest",label:"HTTP request",description:"Call external HTTP APIs.",category:"Action"},{type:"Parser",label:"Parser",description:"Extract values from JSON or XML.",category:"Action"}];function gt(l,o,n,f){return{id:l,type:"flowNode",position:n,data:{onOpenConfig:f,blockType:o.type,label:o.label,description:o.description,allowErrorOutput:o.type==="If"||o.type==="Loop",switchCases:o.type==="Switch"?[""]:void 0},className:"flow-node",style:{width:220}}}function Bs(){const{id:l}=cs(),o=Number(l);us("editor-wide");const{workflow:n,workflowLoading:f,workflowError:V,loadWorkflow:I,variables:$,variablesLoading:Te,variablesError:We,loadVariables:Ve,createVariable:He,updateVariable:Ae,deleteVariable:Y}=Cs(),[ye,Q]=a.useState(null),[ue,oe]=a.useState(null),[bt,mt]=a.useState(!1),[ca,xe]=a.useState(!1),[ve,ht]=a.useState({}),[ua,Fe]=a.useState(null),[da,Ie]=a.useState(null),[wt,St]=a.useState(!1),[kt,Et]=a.useState(!1),[fa,pa]=a.useState(!1),[Ct,ne]=a.useState(!1),[ga,Re]=a.useState(""),[ya,Ne]=a.useState("All"),[Tt,je]=a.useState(!1),[H,be]=a.useState(null),[_,$e]=a.useState(null),[Z,me]=a.useState(null),[ee,he]=a.useState(null),[ba,Vt]=a.useState(!1),[Ue,z]=a.useState(null),[B,re]=a.useState([]),[O,ie]=a.useState(null),[De,we]=a.useState(null),[ma,ha]=a.useState({}),[xt,vt]=a.useState({}),[It,Rt]=a.useState({}),[U,Me]=a.useState({}),[Nt,Je]=a.useState({}),[jt,ze]=a.useState({}),[Se,Ke]=a.useState(""),[qe,Xe]=a.useState(""),[de,$t]=a.useState(null),[Ge,Ye]=a.useState(""),[Qe,Ze]=a.useState(""),[Le,fe]=a.useState(!1),[et,pe]=a.useState(null),[A,Dt]=a.useState([]),[Mt,tt]=a.useState(!1),[Lt,Bt]=a.useState([]),[wa,Sa]=a.useState(!1),[ka,Ea]=a.useState(!0),[le,Ca]=a.useState(!1),Pt=a.useRef(null),_t=a.useRef(new Map),[Ot,at]=a.useState({}),[Be,st]=a.useState({}),[Wt,ot]=a.useState({}),[Ht,nt]=a.useState({}),{theme:Ta,toggleTheme:Va}=ls(),At={subtitle:"Design blocks and connections with React Flow.",untitled:"Workflow"},[R,D]=a.useState([]),[F,N]=a.useState([]),K=a.useRef(null),Ft=a.useRef(null),Ut=a.useRef(null),Jt=a.useRef(null),zt=a.useRef(null),q=a.useRef(null);a.useEffect(()=>()=>{K.current&&window.clearTimeout(K.current)},[]),a.useEffect(()=>{H&&(Ft.current=H,q.current="edge",z(null))},[H]),a.useEffect(()=>{_&&(Ut.current=_,q.current="node",z(null))},[_]),a.useEffect(()=>{Z&&(Jt.current=Z,q.current="selection",z(null))},[Z]),a.useEffect(()=>{ee&&(zt.current=ee,q.current="canvas",z(null))},[ee]),a.useEffect(()=>{H||_||Z||ee||Ue||q.current&&(z(q.current),K.current=window.setTimeout(()=>{z(null),q.current=null,K.current=null},150))},[ee,Ue,H,_,Z]),a.useEffect(()=>{le||D(e=>e.map(s=>{if(s.data.blockType!=="Switch")return s;const c=U[s.id],r=c?Ee(c.cases):[""],d=s.data.switchCases??[];return d.length===r.length&&d.every((b,v)=>b===r[v])?s:{...s,data:{...s.data,switchCases:r}}}))},[le,D,U]),a.useEffect(()=>{le||N(e=>{let s=!1;const c=e.map(r=>{var C;const d=R.find(h=>h.id===r.source);if(!d||d.data.blockType!=="Switch")return r;const g=r.sourceHandle??"";if(!g.startsWith("case-")&&g!=="default")return r;if(g==="default"){const h=r.data??{};return h.caseValue!==""||h.label!==""||r.label!=="Default"?(s=!0,{...r,data:{...h,label:"",caseValue:""},label:"Default"}):r}const y=g.split("-"),b=Number(y[1])-1;if(!Number.isFinite(b)||b<0)return r;const M=(Ee((C=U[d.id])==null?void 0:C.cases)[b]??"").trim(),t=Ce(b,M||void 0)||void 0,p=r.data??{};return p.caseValue!==M||p.label!==M||r.label!==t?(s=!0,{...r,data:{...p,label:M,caseValue:M},label:t}):r});return s?c:e})},[le,R,N,U]);const W=a.useCallback(e=>{const s=Date.now()+Math.random();Bt(c=>[...c,{id:s,message:e}]),window.setTimeout(()=>{Bt(c=>c.filter(r=>r.id!==s))},3500)},[]),x=a.useCallback(()=>{tt(e=>e||!0),oe(e=>e==="Unsaved changes"?e:"Unsaved changes")},[]),{historyRef:Kt,initialSnapshotCaptured:rt,pushHistory:j,undoHistory:qt,copySelection:Xt,pasteClipboard:xa}=Ts({nodes:R,edges:F,setNodes:D,setEdges:N,markDirty:x}),Gt=a.useCallback(()=>{qt(),re([]),be(null),$e(null),me(null),he(null),ie(null),ne(!1),je(!1),we(null)},[N,D,qt]),Yt=a.useCallback(()=>{B.length!==0&&Xt(B)},[Xt,B]),Qt=a.useCallback(()=>{const e=xa();if(!e||e.nodes.length===0)return;j();const s=Date.now(),c=new Map,r=30,d=e.nodes.map((y,b)=>{const v=`paste-${s}-${b}`;return c.set(y.id,v),{...y,id:v,position:{x:y.position.x+r,y:y.position.y+r}}}),g=e.edges.filter(y=>c.has(y.source)&&c.has(y.target)).map((y,b)=>({...y,id:`paste-edge-${s}-${b}`,source:c.get(y.source)??y.source,target:c.get(y.target)??y.target}));D(y=>[...y,...d]),N(y=>[...y,...g]),re(d.map(y=>y.id)),x()},[x,j,N,D]);a.useEffect(()=>{rt.current||R.length===0&&F.length===0||(Kt.current=[{nodes:Vs(R),edges:xs(F)}],rt.current=!0)},[F,R]),a.useEffect(()=>{Kt.current=[],rt.current=!1},[o]);const ge=a.useCallback(e=>{we(e),xe(!1)},[]),va=a.useCallback(()=>{we(null)},[]);a.useEffect(()=>{if(!Number.isFinite(o)){Q("Invalid workflow id.");return}Q(null),I(o)},[I,o]),a.useEffect(()=>{let e=!1;async function s(){if(!(!n||A.length===0))try{Vt(!0);let c=_t.current.get(n.id);if(!c){const t=await fetch(`${G}/api/Workflow/${n.id}/graph`);if(!t.ok)throw new Error(`Failed to load workflow graph (${t.status})`);c=await t.json(),_t.current.set(n.id,c)}const r=J(c.blocks),d=new Map,g=new Map,y=new Map,b=r.map((t,p)=>{var u;const m=t.systemBlockType||"Default",C=t.name||m,h=`block-${t.id}`;let L;if(d.set(t.id,h),g.set(t.id,m),m==="Calculation"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);vt(k=>({...k,[h]:{operation:i.Operation??"Add",firstVariable:i.FirstVariable?_e(i.FirstVariable):"",secondVariable:i.SecondVariable?_e(i.SecondVariable):"",resultVariable:i.ResultVariable?_e(i.ResultVariable):""}}))}catch{}if(m==="If"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);Rt(k=>({...k,[h]:{dataType:i.DataType??"String",first:i.First??"",second:i.Second??""}}))}catch{}if(m==="Switch"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig),k=Ee(i.Cases);L=k,y.set(t.id,k),Me(w=>({...w,[h]:{expression:i.Expression??"",cases:k}}))}catch{}if(m==="HttpRequest"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);Je(k=>({...k,[h]:{method:i.Method??"GET",url:i.Url??"",body:i.Body??"",headers:(i.Headers??[]).map(w=>({name:(w.name??"").trim(),value:(w.value??"").trim()})).filter(w=>w.name||w.value),authType:i.AuthType??"none",bearerToken:i.BearerToken??"",basicUsername:i.BasicUsername??"",basicPassword:i.BasicPassword??"",apiKeyName:i.ApiKeyName??"",apiKeyValue:i.ApiKeyValue??"",responseVariable:i.ResponseVariable??""}}))}catch{}if(m==="Parser"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);ze(k=>{var w;return{...k,[h]:{format:i.Format??"json",sourceVariable:i.SourceVariable??"",mappings:((w=i.Mappings)==null?void 0:w.map(T=>({path:(T.path??"").trim(),variable:(T.variable??"").trim()})).filter(T=>T.path.length>0&&T.variable.length>0))??[]}}})}catch{}if(m==="TextTransform"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);ot(k=>({...k,[h]:{input:i.Input??"",inputVariable:i.InputVariable??"",operation:i.Operation??"Trim",resultVariable:i.ResultVariable??"result"}}))}catch{}if(m==="Loop"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);at(k=>({...k,[h]:{iterations:i.Iterations??1}}))}catch{}if(m==="Wait"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);st(k=>({...k,[h]:{delayMs:i.DelayMs??0,delayVariable:i.DelayVariable??""}}))}catch{}if(m==="TextReplace"&&t.jsonConfig)try{const i=JSON.parse(t.jsonConfig);nt(k=>{var w;return{...k,[h]:{input:i.Input??"",inputVariable:i.InputVariable??"",resultVariable:i.ResultVariable??"result",replacements:((w=i.Replacements)==null?void 0:w.map(T=>({from:T.From??"",to:T.To??"",useRegex:T.UseRegex??!1,ignoreCase:T.IgnoreCase??!1})))??[{from:"",to:"",useRegex:!1,ignoreCase:!1}]}}})}catch{}return{id:h,type:"flowNode",position:{x:t.positionX??120+p%3*260,y:t.positionY??100+Math.floor(p/3)*160},data:{blockType:m,label:C,description:((u=A.find(i=>i.type===m))==null?void 0:u.description)??"Workflow block",onOpenConfig:ge,allowErrorOutput:m==="If",switchCases:m==="Switch"?L??[""]:void 0},className:"flow-node",style:{width:220}}}),v=J(c.connections).filter(t=>d.has(t.sourceBlockId)&&d.has(t.targetBlockId));console.debug("[Flowforge] Filtered connections",v);const M=new Map,E=v.map(t=>{const p=g.get(t.sourceBlockId),m=p==="If",C=p==="Switch",h=p==="Loop",L=m&&t.connectionType==="Error"?"#d64545":m&&t.connectionType==="Success"?"#2f9e68":pt,u=m?t.connectionType==="Error"?"error":"success":h?t.connectionType==="Error"?"error":"loop":void 0;let i=t.Label??void 0,k,w;if(C){const T=(t.Label??"").trim(),te=y.get(t.sourceBlockId)??[];if(T.length===0){const P=M.get(t.sourceBlockId)??0;if(M.set(t.sourceBlockId,P+1),P<te.length){const ae=(te[P]??"").trim();i=Ce(P,ae),k={label:ae,caseValue:ae},w=`case-${P+1}`}else i="Default",k={label:"",caseValue:""},w="default"}else{const P=te.findIndex(ae=>ae.trim()===T);P>=0?(i=Ce(P,T),k={label:T,caseValue:T},w=`case-${P+1}`):(i=T,k={label:T,caseValue:T})}}return h&&!i&&(i=t.connectionType==="Error"?"Exit":"Loop"),{id:`edge-${t.id}`,source:d.get(t.sourceBlockId),target:d.get(t.targetBlockId),sourceHandle:w??u,animated:!0,type:"smoothstep",markerEnd:{type:"arrowclosed",color:L},style:{stroke:L,strokeWidth:2.5,...Na,...m&&t.connectionType==="Error"?{strokeDasharray:"6 4"}:{}},...ja,data:k??(t.Label?{label:t.Label}:void 0),label:i}});e||(D(b),N(E),tt(!1))}catch(c){e||Q(c instanceof Error?c.message:"Unable to load workflow graph")}finally{e||Vt(!1)}}return s(),()=>{e=!0}},[ge,N,D,A,n]),a.useEffect(()=>{let e=!1;async function s(){const c=Pt.current;if(c&&c.some(r=>r.type==="Loop")&&c.some(r=>r.type==="Wait")){Dt(c);return}try{const r=await fetch(`${G}/api/SystemBlock`);if(!r.ok)throw new Error(`Failed to load system blocks (${r.status})`);const d=await r.json();if(!e){const g=J(d);Pt.current=g,Dt(g)}}catch(r){e||Q(r instanceof Error?r.message:"Unable to load system blocks")}}return s(),()=>{e=!0}},[]),a.useEffect(()=>{Number.isFinite(o)&&Ve(o)},[Ve,o]);const Ia=a.useCallback(e=>{if(le)return;const s=e.some(r=>r.type==="position"?r.dragging===!0:r.type!=="select"&&r.type!=="dimensions");e.some(r=>r.type!=="select"&&r.type!=="dimensions"&&!(r.type==="position"&&r.dragging))&&j(),s&&x()},[le,x,j]),Ra=a.useCallback(e=>{e.some(c=>c.type!=="select")&&(j(),x())},[x,j]),Zt=a.useCallback(e=>{var s,c;return(c=(s=R.find(r=>r.id===e))==null?void 0:s.data)==null?void 0:c.blockType},[R]),it=a.useCallback(e=>e!=="End",[]),lt=a.useCallback(e=>e!=="Start",[]),Na=a.useMemo(()=>({strokeLinecap:"round",strokeLinejoin:"round",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.15))"}),[]),ja=a.useMemo(()=>({labelBgPadding:[6,4],labelBgBorderRadius:10,labelBgStyle:{fill:"rgba(0,0,0,0.55)",stroke:"none"},labelStyle:{fill:"#fff",fontWeight:600,fontSize:11}}),[]),X=a.useCallback((e,s)=>F.some(c=>c.source===e&&(c.sourceHandle??"")===(s??"")),[F]),$a=a.useCallback((e,s)=>{var p,m;be(null);const c=(p=s.data)==null?void 0:p.blockType,r=c==="Start"?"source":c==="End"?"target":"either";if(!O){ie({id:s.id,role:r});return}if(O.id===s.id){ie(null);return}const d=Zt(O.id),g=c,y=it(d),b=lt(d),v=it(g),M=lt(g);if(!y&&!b){ie(null);return}if(!v&&!M){ie(null);return}let E=null,t=null;if(O.role==="source"?M&&(E=O.id,t=s.id):O.role==="target"?v&&(E=s.id,t=O.id):r==="source"&&b?(E=s.id,t=O.id):r==="target"&&y||y&&M?(E=O.id,t=s.id):b&&v&&(E=s.id,t=O.id),E&&t){const C=R.find(te=>te.id===E),h=C==null?void 0:C.data.blockType,L=h==="Switch",u=h==="If";let i,k,w;if(L){const P=F.filter(ce=>ce.source===E).filter(ce=>(ce.sourceHandle??"").startsWith("case-")).length,ae=((m=U[E])==null?void 0:m.cases)??[];if(P<ae.length){const ce=P,sa=(ae[ce]??"").trim();w=sa,k=Ce(ce,sa),i=`case-${ce+1}`}else w="",k="",i="default"}else if(h==="If")if(!X(E,"success"))i="success";else if(!X(E,"error"))i="error";else{W("This output already has a connection.");return}else if(h==="Loop")if(!X(E,"loop"))i="loop";else if(!X(E,"error"))i="error";else{W("This output already has a connection.");return}else if(X(E)){W("This output already has a connection.");return}if(i&&X(E,i)){W("This output already has a connection.");return}const T=h==="If"&&i==="error"?"#d64545":h==="If"&&i==="success"?"#2f9e68":pt;j(),N(te=>{const P={id:`${E}-${t}-${Date.now()}`,source:E,target:t,sourceHandle:i,animated:!0,type:"smoothstep",style:{stroke:T,strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.15))",...u&&i==="error"?{strokeDasharray:"6 4"}:{}},markerEnd:{type:"arrowclosed",color:T},labelBgPadding:[6,4],labelBgBorderRadius:10,labelBgStyle:{fill:"rgba(0,0,0,0.55)",stroke:"none"},labelStyle:{fill:"#fff",fontWeight:600,fontSize:11},data:k!==void 0?{label:w??k,caseValue:w}:void 0,label:i==="default"?"Default":k&&k.length>0?k:void 0};return[...te,P]}),x()}ie(null)},[it,lt,F,Zt,X,x,R,O,j,N,W,U]),Da=a.useCallback(e=>{var M;const s=`${e.source??""}-${e.sourceHandle??""}-${e.target??""}-${e.targetHandle??""}`,c=e.sourceHandle??void 0;if(e.source&&X(e.source,c)){W("This output already has a connection.");return}const r=R.find(E=>E.id===e.source),d=(r==null?void 0:r.data.blockType)==="If",g=(r==null?void 0:r.data.blockType)==="Switch",y=d&&e.sourceHandle==="error"?"#d64545":d&&e.sourceHandle==="success"?"#2f9e68":pt;let b,v;if(g){const E=c??"",t=((M=U[(r==null?void 0:r.id)??""])==null?void 0:M.cases)??[];if(E.startsWith("case-")){const p=E.split("-"),m=Number(p[1])-1;v=(m>=0?t[m]??"":"").trim(),b=v,b=((m>=0?Ce(m,v):v)??v)||void 0}else E==="default"&&(v="",b="",b="Default")}j(),N(E=>{const t={id:`${s}-${Date.now()}`,source:e.source??"",target:e.target??"",sourceHandle:e.sourceHandle??void 0,targetHandle:e.targetHandle??void 0,animated:!0,type:"smoothstep",style:{stroke:y,strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round",filter:"drop-shadow(0 1px 2px rgba(0,0,0,0.15))",...e.sourceHandle==="error"?{strokeDasharray:"6 4"}:{}},markerEnd:{type:"arrowclosed",color:y},labelBgPadding:[6,4],labelBgBorderRadius:10,labelBgStyle:{fill:"rgba(0,0,0,0.55)",stroke:"none"},labelStyle:{fill:"#fff",fontWeight:600,fontSize:11},data:b!==void 0?{label:b,caseValue:v}:void 0,label:b&&b.length>0?b:void 0};return[...E,t]}),x()},[X,x,R,j,W,N,U]),Ma=a.useCallback((e,s)=>{e.stopPropagation(),be({id:s.id,x:e.clientX,y:e.clientY})},[]),La=a.useCallback((e,s)=>{e.preventDefault(),e.stopPropagation(),$e({id:s.id,x:e.clientX,y:e.clientY})},[]),Ba=a.useCallback(e=>{const s=e.nodes.map(c=>c.id);re(s)},[]),Pa=a.useCallback((e,s)=>{e.preventDefault(),e.stopPropagation(),!(s.length<2)&&(me({x:e.clientX,y:e.clientY}),re(s.map(c=>c.id)))},[]),_a=a.useCallback(e=>{e.preventDefault(),he({x:e.clientX,y:e.clientY})},[]),ea=a.useCallback(()=>{K.current&&(window.clearTimeout(K.current),K.current=null);const e=H?"edge":_?"node":Z?"selection":ee?"canvas":null;if(!e){z(null);return}q.current=e,z(e),K.current=window.setTimeout(()=>{be(null),$e(null),me(null),he(null),ie(null),je(!1),z(null),q.current=null,K.current=null},200)},[ee,H,_,Z]),ta=a.useCallback(()=>{je(e=>!e),ne(!1),xe(!1),Re(""),Ne("All")},[]),Oa=a.useCallback(()=>{H&&(j(),N(e=>e.filter(s=>s.id!==H.id)),be(null),x())},[H,x,j,N]),Wa=a.useCallback(()=>{_&&(j(),D(e=>e.filter(s=>s.id!==_.id)),N(e=>e.filter(s=>s.source!==_.id&&s.target!==_.id)),$e(null),x())},[x,_,j,N,D]),Ha=a.useCallback(()=>{B.length!==0&&(j(),D(e=>e.filter(s=>!B.includes(s.id))),N(e=>e.filter(s=>!B.includes(s.source)&&!B.includes(s.target))),me(null),re([]),x())},[x,j,B,N,D]),ct=a.useCallback(()=>{re(R.map(e=>e.id)),he(null)},[R]),Aa=a.useCallback(()=>{if(B.length===0)return;const e=Date.now(),s=new Map;j(),D(c=>{const d=c.filter(g=>B.includes(g.id)).map((g,y)=>{const b=`dup-${g.id}-${e}-${y}`;return s.set(g.id,b),{...g,id:b,position:{x:g.position.x+40,y:g.position.y+40}}});return[...c,...d]}),N(c=>{const r=c.filter(d=>B.includes(d.source)&&B.includes(d.target)).map((d,g)=>({...d,id:`dup-edge-${d.id}-${e}-${g}`,source:s.get(d.source)??d.source,target:s.get(d.target)??d.target}));return[...c,...r]}),me(null),re(Array.from(s.values())),x()},[x,j,B,N,D]);a.useEffect(()=>{const e=s=>{const c=s.target,r=c==null?void 0:c.tagName;if((c==null?void 0:c.isContentEditable)||r==="INPUT"||r==="TEXTAREA"||r==="SELECT"||(c==null?void 0:c.getAttribute("role"))==="textbox")return;const g=s.key.toLowerCase();(s.metaKey||s.ctrlKey)&&(g==="a"?(s.preventDefault(),ct()):g==="c"?(s.preventDefault(),Yt()):g==="v"?(s.preventDefault(),Qt()):g==="z"&&(s.preventDefault(),Gt()))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[Yt,Qt,ct,Gt]);const Fa=a.useCallback(e=>{if(!(A.length===0||A.some(d=>d.type===e.type)||e.type==="Loop"||e.type==="Wait"||e.type==="TextTransform"||e.type==="TextReplace")){oe(`${e.label} block is not available on this server.`);return}if((e.type==="Start"||e.type==="End")&&R.some(g=>g.data.blockType===e.type)){oe(`${e.type} block already exists.`);return}const c=e.position??{x:80+R.length*40,y:80},r=gt(`${e.type}-${Date.now()}`,e,c,ge);j(),D(d=>[...d,r]),e.type==="HttpRequest"&&Je(d=>({...d,[r.id]:{method:"GET",url:"",body:"",headers:[],authType:"none",bearerToken:"",basicUsername:"",basicPassword:"",apiKeyName:"",apiKeyValue:"",responseVariable:""}})),e.type==="Parser"&&ze(d=>({...d,[r.id]:{format:"json",sourceVariable:"",mappings:[]}})),e.type==="Switch"&&Me(d=>({...d,[r.id]:{expression:"",cases:[""]}})),e.type==="Loop"&&at(d=>({...d,[r.id]:{iterations:1}})),e.type==="Wait"&&st(d=>({...d,[r.id]:{delayMs:1e3,delayVariable:""}})),e.type==="TextTransform"&&ot(d=>({...d,[r.id]:{input:"",inputVariable:"",operation:"Trim",resultVariable:"result"}})),e.type==="TextReplace"&&nt(d=>({...d,[r.id]:{input:"",inputVariable:"",resultVariable:"result",replacements:[{from:"",to:"",useRegex:!1,ignoreCase:!1}]}})),ne(!1),Re(""),Ne("All"),x()},[x,R,ge,j,D,oe,Me,A]),aa=a.useMemo(()=>f?"Loading workflow...":ye||V?ye??V:n?"":"Workflow not found.",[ye,n,V,f]),Ua=a.useMemo(()=>{const e=We??et;return Te?"Loading variables...":e||($.length===0?"No variables yet.":"")},[$,We,et,Te]),Ja=a.useMemo(()=>{const e=new Map;return A.forEach(s=>e.set(s.type,s)),e},[A]),za=a.useMemo(()=>{if(A.length===0)return Oe;const e=new Set(A.map(s=>s.type));return Oe.filter(s=>e.has(s.type)||s.type==="Loop"||s.type==="Wait"||s.type==="TextTransform"||s.type==="TextReplace")},[A]),ut=a.useMemo(()=>{const e={};return $.forEach(s=>{e[s.name]=s.defaultValue??""}),e},[$]),Ka=a.useMemo(()=>{let s=0;return Object.values(Be).forEach(c=>{let r=0;const d=(c.delayVariable??"").trim();if(d.length>0){const g=d.startsWith("$")?d.slice(1):d,y=ve[g]??ut[g],b=Number(y);Number.isFinite(b)&&b>0&&(r=b)}r<=0&&Number.isFinite(c.delayMs)&&(r=c.delayMs??0),r=Math.max(0,Math.min(r,3e5)),s+=r}),s},[ut,ve,Be]);async function qa(e){if(e.preventDefault(),!(!Se.trim()||Le||!n)){fe(!0),x(),pe(null);try{await He({name:Se.trim(),defaultValue:qe.trim()||null,workflowId:n.id}),Ke(""),Xe("")}catch(s){const c=s instanceof Error?s.message:"Unable to create variable";pe(c),W(c)}finally{fe(!1)}}}function Xa(e){$t(e.id),Ye(e.name),Ze(e.defaultValue??"")}function Pe(){$t(null),Ye(""),Ze("")}async function Ga(){if(n){if(de!==null){const e=Ge.trim();if(!e)throw new Error("Variable name cannot be empty.");await Ae({id:de,name:e,defaultValue:Qe.trim()||null,workflowId:n.id}),Pe()}Se.trim()&&(await He({name:Se.trim(),defaultValue:qe.trim()||null,workflowId:n.id}),Ke(""),Xe(""))}}async function Ya(e){if(e.preventDefault(),de===null||Le||!n)return;const s=Ge.trim();if(s){fe(!0),x(),pe(null);try{await Ae({id:de,name:s,defaultValue:Qe.trim()||null,workflowId:n.id}),Pe()}catch(c){const r=c instanceof Error?c.message:"Unable to update variable";pe(r),W(r)}finally{fe(!1)}}}async function Qa(e){if(!Le){fe(!0),x(),pe(null);try{await Y(e,(n==null?void 0:n.id)??0),de===e&&Pe()}catch(s){const c=s instanceof Error?s.message:"Unable to delete variable";pe(c),W(c)}finally{fe(!1)}}}function Za(){xe(!0),ne(!1),je(!1),we(null),Ie(Mt?"Save the workflow before running.":null),Fe(null),ht(ut),Et(!1)}async function es(){if(!(!n||wt)){if(Mt){Ie("Save the workflow before running.");return}St(!0),Ie(null),Fe(null);try{const e=await fetch(`${G}/api/Workflow/${n.id}/run?skipWaits=${kt?"true":"false"}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)});if(!e.ok)throw new Error(`Run failed (${e.status})`);const s=await e.json(),c={...s,path:J(s.path??[]),actions:J(s.actions??[])};Fe(c)}catch(e){const s=e instanceof Error?e.message:"Unable to run workflow";Ie(s),W(s)}finally{St(!1)}}}async function ts(){if(!(!n||bt)){mt(!0),oe(null),Q(null);try{await Ga(),console.debug("[Flowforge] Saving workflow",n.id);const e=await fetch(`${G}/api/Workflow/${n.id}/graph`);if(!e.ok)throw new Error(`Failed to load workflow graph (${e.status})`);const s=await e.json();console.debug("[Flowforge] Existing graph",s);const c=J(s.blocks).map(t=>({id:t.id})),r=J(s.connections).map(t=>({id:t.id}));for(const t of r){const p=await fetch(`${G}/api/BlockConnection/${t.id}`,{method:"DELETE"});if(!p.ok)throw new Error(`Failed to delete connection (${p.status})`)}for(const t of c){const p=await fetch(`${G}/api/Blocks/${t.id}`,{method:"DELETE"});if(!p.ok)throw new Error(`Failed to delete block (${p.status})`)}const d=R.filter(t=>t.data.blockType==="Start"),g=R.filter(t=>t.data.blockType==="End"),y=R.filter(t=>t.data.blockType!=="Start"&&t.data.blockType!=="End"),b=[...d.length>0?[d[0]]:[],...y,...g.length>0?[g[0]]:[]];if(d.length===0){const t=Oe.find(p=>p.type==="Start");t&&b.unshift(gt(`auto-start-${Date.now()}`,t,{x:120,y:80},ge))}if(g.length===0){const t=Oe.find(p=>p.type==="End");t&&b.push(gt(`auto-end-${Date.now()}`,t,{x:420,y:80},ge))}(d.length>1||g.length>1)&&oe("Only one Start/End block is saved. Extra blocks were skipped.");let v=Ja;if(b.map(t=>t.data.blockType).filter(t=>!v.has(t)).length>0){const t=await fetch(`${G}/api/SystemBlock`);if(!t.ok)throw new Error(`Failed to load system blocks (${t.status})`);const p=J(await t.json());v=new Map,p.forEach(m=>v.set(m.type,m))}const E=new Map;for(const t of b){const p=t.data.blockType,m=v.get(p);if(!m)throw new Error(`Missing system block for type "${p}". Ensure the API has this SystemBlock (run migrations/seed).`);let C=null;if(p==="Calculation"){const u=xt[t.id];u&&(C=JSON.stringify({Operation:u.operation,FirstVariable:u.firstVariable,SecondVariable:u.secondVariable,ResultVariable:u.resultVariable}))}if(p==="If"){const u=It[t.id];u&&(C=JSON.stringify({DataType:u.dataType,First:u.first,Second:u.second}))}if(p==="Switch"){const u=U[t.id];if(u){const k=Ee(u.cases).map(w=>w.trim()).filter(w=>w.length>0);C=JSON.stringify({Expression:u.expression,Cases:k})}}if(p==="HttpRequest"){const u=Nt[t.id];u&&(C=JSON.stringify({Method:u.method,Url:u.url,Body:u.body??"",Headers:u.headers.filter(i=>i.name||i.value),AuthType:u.authType,BearerToken:u.bearerToken??"",BasicUsername:u.basicUsername??"",BasicPassword:u.basicPassword??"",ApiKeyName:u.apiKeyName??"",ApiKeyValue:u.apiKeyValue??"",ResponseVariable:u.responseVariable??""}))}if(p==="Parser"){const u=jt[t.id];u&&(C=JSON.stringify({Format:u.format,SourceVariable:u.sourceVariable,Mappings:u.mappings}))}if(p==="Loop"){const u=Ot[t.id];u&&(C=JSON.stringify({Iterations:u.iterations}))}if(p==="Wait"){const u=Be[t.id];u&&(C=JSON.stringify({DelayMs:u.delayMs??0,DelayVariable:u.delayVariable??""}))}if(p==="TextTransform"){const u=Wt[t.id];u&&(C=JSON.stringify({Input:u.input??"",InputVariable:u.inputVariable??"",Operation:u.operation,ResultVariable:u.resultVariable??"result"}))}if(p==="TextReplace"){const u=Ht[t.id];u&&(C=JSON.stringify({Input:u.input??"",InputVariable:u.inputVariable??"",ResultVariable:u.resultVariable??"result",Replacements:(u.replacements??[]).map(i=>({From:i.from??"",To:i.to??"",UseRegex:i.useRegex??!1,IgnoreCase:i.ignoreCase??!1}))}))}const h=await fetch(`${G}/api/Blocks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.data.label,workflowId:n.id,systemBlockId:m.id,jsonConfig:C,positionX:t.position.x,positionY:t.position.y})});if(!h.ok){let u=`Failed to save block (${h.status})`;try{const i=await h.json();i!=null&&i.message&&(u=i.message)}catch{}throw new Error(u)}const L=await h.json();console.debug("[Flowforge] Saved block",{nodeId:t.id,blockId:L.id}),E.set(t.id,L.id)}for(const t of F){const p=E.get(t.source),m=E.get(t.target);if(!p||!m)continue;const C=b.find(u=>E.get(u.id)===p);let h="Success";((C==null?void 0:C.data.blockType)==="If"||(C==null?void 0:C.data.blockType)==="Loop")&&(t.sourceHandle==="error"?h="Error":t.sourceHandle==="success"||t.sourceHandle==="loop"?h="Success":h=F.filter(w=>w.source===C.id).map((w,T)=>({item:w,index:T})).sort((w,T)=>(w.item.sourceHandle??"").localeCompare(T.item.sourceHandle??"")||w.index-T.index).findIndex(w=>w.item.id===t.id||w.item.source===t.source&&w.item.target===t.target)===1?"Error":"Success");const L=await fetch(`${G}/api/BlockConnection`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceBlockId:p,targetBlockId:m,connectionType:h,label:t.data&&"caseValue"in t.data&&t.data.caseValue!==void 0?t.data.caseValue:t.data&&"label"in t.data?t.data.label:t.label})});if(!L.ok){let u=`Failed to save connection (${L.status})`;try{const i=await L.json();i!=null&&i.message&&(u=i.message)}catch{}throw new Error(u)}console.debug("[Flowforge] Saved connection",{sourceId:p,targetId:m})}await Ve(n.id),tt(!1),oe("Saved")}catch(e){const s=e instanceof Error?e.message:"Unable to save workflow";Q(s),W(s)}finally{mt(!1)}}}return S.jsxs("div",{className:"editor-shell",children:[aa?S.jsx("div",{className:"state",children:aa}):S.jsxs("div",{className:"editor-body",children:[S.jsx(a.Suspense,{fallback:S.jsx("div",{className:"editor-topbar"}),children:S.jsx(Ds,{workflowName:(n==null?void 0:n.name)??At.untitled,subtitle:At.subtitle,saveStatus:ue,saving:bt,workflowLoading:f,theme:Ta,onToggleTheme:Va,onSave:ts,onRun:Za})}),S.jsxs("div",{className:"editor-main",children:[S.jsx(a.Suspense,{fallback:S.jsx("div",{className:"editor-sidebar"}),children:S.jsx(vs,{showPalette:Ct,showVariables:Tt,onTogglePalette:()=>ne(e=>!e),onToggleVariables:ta})}),S.jsx(a.Suspense,{fallback:S.jsx("div",{className:"canvas-wrapper"}),children:S.jsx(Ns,{nodes:R,setNodes:D,edges:F,setEdges:N,snapToGrid:ka,isDragging:le,setIsDragging:Ca,workflowLoading:f,graphLoading:ba,onConnect:Da,onEdgeClick:Ma,onNodeClick:$a,onNodeContextMenu:La,onSelectionChange:Ba,onSelectionContextMenu:Pa,onPaneClick:ea,onPaneContextMenu:_a,onToggleSnap:()=>Ea(e=>!e),onNodesMutate:Ia,onEdgesMutate:Ra})})]}),Ct&&S.jsx(a.Suspense,{fallback:S.jsx("div",{className:"variables-drawer blocks-drawer",style:{padding:16},children:"Loading blocks..."}),children:S.jsx(Is,{onClose:()=>{ne(!1),Re(""),Ne("All")},onCreate:Fa,search:ga,onSearchChange:Re,category:ya,onCategoryChange:Ne,availableTemplates:za})}),Tt&&S.jsx(a.Suspense,{fallback:S.jsx("div",{className:"variables-drawer",style:{padding:16},children:"Loading variables..."}),children:S.jsx(Rs,{variables:$,variablesStatus:Ua,variablesSaving:Le,variablesLocalError:et,newVariableName:Se,newVariableDefault:qe,editingVariableId:de,editingVariableName:Ge,editingVariableDefault:Qe,onClose:ta,onCreate:qa,onUpdate:Ya,onDelete:Qa,onStartEdit:Xa,onCancelEdit:Pe,setNewVariableName:Ke,setNewVariableDefault:Xe,setEditingVariableName:Ye,setEditingVariableDefault:Ze,markDirty:x})}),S.jsx(a.Suspense,{fallback:null,children:S.jsx(Ms,{edgeMenu:H,nodeMenu:_,selectionMenu:Z,canvasMenu:ee,closingMenu:Ue,lastEdgeMenu:Ft.current,lastNodeMenu:Ut.current,lastSelectionMenu:Jt.current,lastCanvasMenu:zt.current,selectedCount:B.length,onDeleteEdge:Oa,onDeleteNode:Wa,onDeleteSelection:Ha,onDuplicateSelection:Aa,onSelectAll:ct,onClose:ea,onOpenPalette:()=>{ne(!0),he(null)}})})]}),De&&S.jsx(a.Suspense,{fallback:S.jsx("aside",{className:"config-drawer",children:S.jsxs("div",{className:"drawer-header",children:[S.jsxs("p",{className:"drawer-title",children:[De.label," settings"]}),S.jsxs("span",{className:"drawer-subtitle",children:[De.blockType," block"]})]})}),children:S.jsx($s,{panel:De,variables:$,startConfigs:ma,setStartConfigs:ha,ifConfigs:It,setIfConfigs:Rt,switchConfigs:U,setSwitchConfigs:Me,loopConfigs:Ot,setLoopConfigs:at,waitConfigs:Be,setWaitConfigs:st,textTransformConfigs:Wt,setTextTransformConfigs:ot,textReplaceConfigs:Ht,setTextReplaceConfigs:nt,calculationConfigs:xt,setCalculationConfigs:vt,httpConfigs:Nt,setHttpConfigs:Je,parserConfigs:jt,setParserConfigs:ze,normalizeSwitchCases:Ee,formatVariableDisplay:Ls,normalizeVariableName:_e,setNodes:D,setPanelLabel:e=>we(s=>s&&{...s,label:e}),markDirty:x,onClose:va})}),ca&&S.jsx(a.Suspense,{fallback:S.jsx("aside",{className:"config-drawer",children:S.jsxs("div",{className:"drawer-header",children:[S.jsx("p",{className:"drawer-title",children:"Run workflow"}),S.jsx("span",{className:"drawer-subtitle",children:n==null?void 0:n.name})]})}),children:S.jsx(js,{workflowId:n==null?void 0:n.id,workflowName:n==null?void 0:n.name,variables:$,runInputs:ve,setRunInputs:ht,running:wt,runError:da,runResult:ua,skipWaits:kt,setSkipWaits:Et,estimatedWaitMs:Ka,showRunSnippet:fa,setShowRunSnippet:pa,showRunInputs:wa,setShowRunInputs:Sa,onRun:es,onClose:()=>xe(!1)})}),Lt.length>0&&S.jsx("div",{style:{position:"fixed",right:16,bottom:16,display:"flex",flexDirection:"column",gap:8,zIndex:9999},"aria-live":"polite",children:Lt.map(e=>S.jsx("div",{style:{background:"#2d2f36",color:"#fff",padding:"10px 12px",borderRadius:6,boxShadow:"0 4px 10px rgba(0,0,0,0.15)",fontSize:14,maxWidth:320},children:e.message},e.id))})]})}function As(){return S.jsx(is,{children:S.jsx(Bs,{})})}export{As as default};
